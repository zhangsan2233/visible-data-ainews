import{_ as tt,r as m,c as h,o as et,q as st,d as r,f as e,y as at,u as nt,g as f,w as C,v as ot,l as lt,s as P,e as it,i as N,t as u,F as A,j as I,x as U,h as c}from"./index-Ga3p35v5.js";const rt={class:"news-container"},ut={class:"top-nav"},ct={class:"nav-content"},dt={class:"nav-actions"},vt={class:"news-main"},pt={class:"filters-section"},mt={class:"filters-content"},ft={class:"search-box"},gt={class:"search-input-wrapper"},ht={class:"fuzzy-match-toggle"},yt={class:"toggle-label"},_t={class:"filter-controls"},wt={class:"filter-group"},bt={class:"filter-group"},kt={class:"stats-section"},Dt={class:"stats-content"},Ct={class:"stat-item"},Nt={class:"stat-value"},Tt={class:"stat-item"},xt={class:"stat-value"},Lt={class:"stat-item"},Mt={class:"stat-value"},St={class:"stat-item"},$t={class:"stat-value"},Ft={key:0,class:"loading-section"},zt={key:1,class:"news-list-section"},Vt={class:"news-list"},Bt={class:"news-header"},Pt={class:"news-title"},At={class:"news-meta"},It={class:"news-time"},Ut={key:0,class:"news-type"},jt={key:0,class:"news-summary"},Et={class:"news-footer"},Rt={class:"news-id"},Yt={key:0,class:"news-actions"},qt=["href"],Gt={key:0,class:"empty-state"},Wt={class:"empty-description"},Qt={key:2,class:"pagination-section"},Ht={class:"pagination-content"},Jt=["disabled"],Kt={class:"pagination-pages"},Ot=["onClick"],Xt={key:0,class:"page-ellipsis"},Zt=["disabled"],te={class:"pagination-info"},M=20,ee={__name:"News",setup(se){const j=nt(),w=m(!1),b=m(null),k=m([]),v=m(""),p=m("all"),y=m("timeDesc"),_=m(!1),o=m(1);function T(a,t){if(!a||!t)return!1;const s=S(a),n=S(t);if(!s||!n)return!1;const l=E(s,n),i=R(s.length);return l>=i}function S(a){return a.toLowerCase().replace(/\s+/g,"").trim()}function E(a,t){let s=0,n=0;for(let l=0;l<a.length;l++){const i=a[l];for(let g=n;g<t.length;g++)if(t[g]===i){s++,n=g+1;break}}return s/a.length}function R(a){return a<2?1:a<=4?.6:.5}function x(a){if(!a)return"æœªçŸ¥æ—¥æœŸ";try{const t=new Date(a);if(isNaN(t.getTime())){const i=a.match(/(\d{4})å¹´(\d{1,2})æœˆ(\d{1,2})æ—¥/);if(i){const[g,B,X,Z]=i;return`${B}-${X.padStart(2,"0")}-${Z.padStart(2,"0")}`}return a}const s=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${s}-${n}-${l}`}catch{return a}}function Y(a){if(!a||a.length===0)return null;const t=a.filter(l=>l.time);if(t.length===0)return null;const n=t.sort((l,i)=>{const g=new Date(l.time);return new Date(i.time)-g})[0].time;return x(n)}function q(a){return{news:"æ–°é—»",summary:"æ‘˜è¦",cluster:"ä¸»é¢˜ç°‡"}[a]||a}const L=h(()=>{let a=k.value;if(v.value.trim()){const t=v.value.toLowerCase().trim();_.value?a=a.filter(s=>T(t,s.title?.toLowerCase())||T(t,s.summary?.toLowerCase())||T(t,s.id?.toLowerCase())):a=a.filter(s=>s.title?.toLowerCase().includes(t)||s.summary?.toLowerCase().includes(t)||s.id?.toLowerCase().includes(t))}if(p.value!=="all"){const t=new Date;a=a.filter(s=>{if(!s.time)return!1;const n=new Date(s.time);if(isNaN(n.getTime()))return!1;const i=(t.getTime()-n.getTime())/(1e3*60*60*24);switch(p.value){case"today":return i<=1;case"week":return i<=7;case"month":return i<=30;case"year":return i<=365;default:return!0}})}return a=[...a].sort((t,s)=>{switch(y.value){case"timeDesc":return new Date(s.time||0)-new Date(t.time||0);case"timeAsc":return new Date(t.time||0)-new Date(s.time||0);case"titleAsc":return(t.title||"").localeCompare(s.title||"");case"titleDesc":return(s.title||"").localeCompare(t.title||"");default:return 0}}),a}),D=h(()=>{const a=(o.value-1)*M,t=a+M;return L.value.slice(a,t)}),d=h(()=>Math.ceil(L.value.length/M)),G=h(()=>k.value.length),$=h(()=>{const a=[],t=Math.max(1,o.value-2),s=Math.min(d.value,t+4);for(let n=t;n<=s;n++)a.push(n);return a}),W=h(()=>d.value>5&&o.value<d.value-2);async function Q(){try{const a=await fetch("/news_graph_causal.json");if(!a.ok)throw new Error("Graph data file not found");return await a.json()}catch(a){return console.warn("Failed to load graph data:",a),null}}async function H(){try{const a=await Q();if(a&&a.force_graph&&a.force_graph.nodes){const t=a.force_graph.nodes.filter(n=>!n.id.startsWith("super")&&n.id!=="summary_global"&&(n.type==="news"||!n.type)),s=Y(t);return{newsList:t.map(n=>({...n,time:x(n.time)})),lastNewsTime:s}}return{newsList:[],lastNewsTime:null}}catch(a){return console.error("Failed to load news list:",a),{newsList:[],lastNewsTime:null}}}const J=async()=>{w.value=!0;try{const{newsList:a,lastNewsTime:t}=await H();if(k.value=a,t)b.value=t;else{const s=new Date,n=s.getFullYear(),l=String(s.getMonth()+1).padStart(2,"0"),i=String(s.getDate()).padStart(2,"0");b.value=`${n}-${l}-${i}`}}catch(a){console.error("Failed to load news data:",a),k.value=[];const t=new Date,s=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");b.value=`${s}-${n}-${l}`}finally{w.value=!1}},F=()=>{o.value=1},K=()=>{o.value>1&&o.value--},O=()=>{o.value<d.value&&o.value++},z=a=>{o.value=a},V=()=>{v.value="",p.value="all",y.value="timeDesc",_.value=!1,o.value=1};return et(()=>{J()}),st([v,p,y,_],()=>{o.value=1}),(a,t)=>(c(),r("div",rt,[e("nav",ut,[e("div",ct,[t[7]||(t[7]=e("div",{class:"logo"},[e("span",{class:"logo-text"},"æ–°é—»åˆ—è¡¨æµè§ˆ")],-1)),e("div",dt,[e("button",{onClick:t[0]||(t[0]=s=>at(j).back()),class:"back-button"},[...t[6]||(t[6]=[e("span",{class:"button-icon"},"â†",-1),e("span",{class:"button-text"},"è¿”å›é¦–é¡µ",-1)])])])])]),e("main",vt,[e("section",pt,[e("div",mt,[e("div",ft,[e("div",gt,[t[8]||(t[8]=e("span",{class:"search-icon"},"ğŸ”",-1)),C(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>v.value=s),onInput:F,type:"text",placeholder:"æœç´¢æ–°é—»æ ‡é¢˜ã€æ‘˜è¦æˆ–ID...",class:"search-input"},null,544),[[ot,v.value]])]),e("div",ht,[e("label",yt,[C(e("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=s=>_.value=s),onChange:F,class:"toggle-input"},null,544),[[lt,_.value]]),t[9]||(t[9]=e("span",{class:"toggle-slider"},null,-1)),t[10]||(t[10]=e("span",{class:"toggle-text"},"å®½æ¾åŒ¹é…",-1))])])]),e("div",_t,[e("div",wt,[t[12]||(t[12]=e("label",{class:"filter-label"},"æ—¶é—´èŒƒå›´ï¼š",-1)),C(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>p.value=s),class:"filter-select"},[...t[11]||(t[11]=[it('<option value="all" data-v-b1d2b69b>å…¨éƒ¨æ—¶é—´</option><option value="today" data-v-b1d2b69b>ä»Šå¤©</option><option value="week" data-v-b1d2b69b>ä¸€å‘¨å†…</option><option value="month" data-v-b1d2b69b>ä¸€æœˆå†…</option><option value="year" data-v-b1d2b69b>ä¸€å¹´å†…</option>',5)])],512),[[P,p.value]])]),e("div",bt,[t[14]||(t[14]=e("label",{class:"filter-label"},"æ’åºæ–¹å¼ï¼š",-1)),C(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>y.value=s),class:"filter-select"},[...t[13]||(t[13]=[e("option",{value:"timeDesc"},"æ—¶é—´é™åº",-1),e("option",{value:"timeAsc"},"æ—¶é—´å‡åº",-1),e("option",{value:"titleAsc"},"æ ‡é¢˜å‡åº",-1),e("option",{value:"titleDesc"},"æ ‡é¢˜é™åº",-1)])],512),[[P,y.value]])]),e("button",{onClick:V,class:"reset-button"},[...t[15]||(t[15]=[e("span",{class:"button-icon"},"ğŸ”„",-1),N(" é‡ç½®ç­›é€‰ ",-1)])])])])]),e("section",kt,[e("div",Dt,[e("div",Ct,[e("div",Nt,u(G.value.toLocaleString()),1),t[16]||(t[16]=e("div",{class:"stat-label"},"æ€»æ–°é—»æ•°",-1))]),e("div",Tt,[e("div",xt,u(L.value.length.toLocaleString()),1),t[17]||(t[17]=e("div",{class:"stat-label"},"ç­›é€‰ç»“æœ",-1))]),e("div",Lt,[e("div",Mt,u(D.value.length),1),t[18]||(t[18]=e("div",{class:"stat-label"},"å½“å‰é¡µ",-1))]),e("div",St,[e("div",$t,u(b.value),1),t[19]||(t[19]=e("div",{class:"stat-label"},"æœ€åæ›´æ–°",-1))])])]),w.value?(c(),r("div",Ft,[...t[20]||(t[20]=[e("div",{class:"loading-spinner"},null,-1),e("p",{class:"loading-text"},"æ­£åœ¨åŠ è½½æ–°é—»æ•°æ®...",-1)])])):(c(),r("section",zt,[e("div",Vt,[(c(!0),r(A,null,I(D.value,s=>(c(),r("div",{key:s.id,class:"news-card"},[e("div",Bt,[e("h3",Pt,u(s.title||"æ— æ ‡é¢˜"),1),e("div",At,[e("span",It,u(x(s.time)||"æœªçŸ¥æ—¶é—´"),1),s.type?(c(),r("span",Ut,u(q(s.type)),1)):f("",!0)])]),s.summary?(c(),r("div",jt,u(s.summary),1)):f("",!0),e("div",Et,[e("div",Rt," ID: "+u(s.id),1),s.url?(c(),r("div",Yt,[e("a",{href:s.url,target:"_blank",class:"news-link"},[...t[21]||(t[21]=[e("span",{class:"link-icon"},"ğŸ”—",-1),N(" æŸ¥çœ‹åŸæ–‡ ",-1)])],8,qt)])):f("",!0)])]))),128))]),!w.value&&D.value.length===0?(c(),r("div",Gt,[t[22]||(t[22]=e("div",{class:"empty-icon"},"ğŸ“°",-1)),t[23]||(t[23]=e("h3",{class:"empty-title"},"æš‚æ— æ–°é—»æ•°æ®",-1)),e("p",Wt,u(v.value||p.value!=="all"?"è¯·å°è¯•è°ƒæ•´æœç´¢æ¡ä»¶æˆ–ç­›é€‰æ¡ä»¶":"ç³»ç»Ÿæ­£åœ¨åŠ è½½æ–°é—»æ•°æ®ï¼Œè¯·ç¨ååˆ·æ–°"),1),v.value||p.value!=="all"?(c(),r("button",{key:0,onClick:V,class:"empty-action"}," é‡ç½®ç­›é€‰æ¡ä»¶ ")):f("",!0)])):f("",!0)])),d.value>1?(c(),r("section",Qt,[e("div",Ht,[e("button",{onClick:K,disabled:o.value===1,class:"pagination-button prev"},[...t[24]||(t[24]=[e("span",{class:"button-icon"},"â†",-1),N(" ä¸Šä¸€é¡µ ",-1)])],8,Jt),e("div",Kt,[(c(!0),r(A,null,I($.value,s=>(c(),r("button",{key:s,onClick:n=>z(s),class:U(["page-button",{active:s===o.value}])},u(s),11,Ot))),128)),W.value?(c(),r("span",Xt,"...")):f("",!0),d.value>1&&!$.value.includes(d.value)?(c(),r("button",{key:1,onClick:t[5]||(t[5]=s=>z(d.value)),class:U(["page-button",{active:d.value===o.value}])},u(d.value),3)):f("",!0)]),e("button",{onClick:O,disabled:o.value===d.value,class:"pagination-button next"},[...t[25]||(t[25]=[N(" ä¸‹ä¸€é¡µ ",-1),e("span",{class:"button-icon"},"â†’",-1)])],8,Zt)]),e("div",te," ç¬¬ "+u(o.value)+" é¡µï¼Œå…± "+u(d.value)+" é¡µï¼Œæ˜¾ç¤º "+u(D.value.length)+" æ¡æ–°é—» ",1)])):f("",!0)])]))}},ne=tt(ee,[["__scopeId","data-v-b1d2b69b"]]);export{ne as default};
